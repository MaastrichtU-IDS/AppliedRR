---
title: 'Applied Research: Analyse, Share and Reproduce Statistics with R Markdown'
author:
- name: Carlos Utrilla Guerrero
date: "6/08/2021"
output:
  html_document: default
description: Working your way through a basic analysis, in a reproducible manner.
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


![](https://maastrichtu-ids.github.io/AppliedRR/pics/logoIDS.png)


# WELCOME

Welcome to the **workshop number 3: Introduction to inferential stats with R.**

**Learning outcomes:**

By the end of this demo, you should be able to:

* Open and create a R Markdown.

* Formulate different hypothesis testing

* Interpret hypothesis testing for comparing means model outputs

* Interpret pearson correlation and scatter plots


## Quick started with hyptohesis testing using [R Markdown](https://rmarkdown.rstudio.com/)

![Artwork by @allison_horst](https://cfss.uchicago.edu/media/allison_horst_art/rmarkdown_rockstar_hu2e508a81a7bfad3089552f8e7186e525_4660528_1200x1200_fit_lanczos_2.png)


R Markdown documents are fully reproducible. Use a productive notebook interface to weave together narrative text and code to produce elegantly formatted output.


If you want to get more familiar with the hand procedure of hypothesis testing, you have a look in the following tutorials:

- [Inferential statistics](http://www.r-tutor.com/elementary-statistics/hypothesis-testing)

- [Hypothesis Testing by Hand: A Single Sample tTest]([https://www.youtube.com/watch?v=yvHQEJnYZBY])


## Using the Student's T-test

R can handle the various versions of T-test using the `t.test()` command. This function can be used to deal with one-sample tests as well as two-sample (un-)paired tests.

### DEMO 1: (Unparied) Independent samples t-test


**Research question:**Is there any (statistical) difference in the mean orange juice poured in a glass of 33cl between Maastricht and Amsterdam coffee lovers?

![](https://club.atlascoffeeclub.com/wp-content/uploads/2019/05/nathan-dumlao-264380-unsplash.jpg)


The independent sample t-test compares the mean of one distinct group to the mean of another group.  

---

#### YOUR TURN

Complete the steps to perform a t-test comparing means. In a markdown, add R script

**Step 1: Formulate the hypothesis**

**Step 2: State level significance**

**Step 3: Collect data from different cities**

```{r}
# Define orange sample
orange_maastricht <- c(28,31,28,37,30,
            33,25,33,24,30)

orange_amsterdam <-  c(24,31,25,37,30,
            33,23,32,24,30)

print(orange_amsterdam)
print(orange_maastricht)

```
**Step 4: Conduct t-test for comparing means**
```{r echo=FALSE}
# Conduct independent t-test
t.test(x = orange_maastricht,   # sample values Maastricht
       y = orange_amsterdam,    # sample values Amsterdam
       paired = FALSE, # different and independent observations from samples
       var.equal = TRUE) # we assume variance are equal thus, we run Student t.test
```

**Step 5: Conclusion & Model Output Interpretation**



### DEMO 2: Gapminder dataset

**Research question:** Is there any (statistical) difference in the mean Life Expectancy between South Africa and Ireland?

![](https://pbs.twimg.com/profile_images/523819488236433408/gAMQQRCu_400x400.png)
---

```{r}
# Create a plot with Data Gapminder
library(gapminder)
library(dplyr)
data("gapminder")
mydat <- filter(gapminder, country == 'South Africa' | country == 'Ireland')

summarize(filter(mydat, country == 'South Africa'),
          Avg_Life_SouthAfrica = mean(lifeExp, na.rm = TRUE))

```
```{r}
summarize(filter(mydat, country == 'Ireland'),
          Avg_Life_Ireland = mean(lifeExp, na.rm = TRUE))
```

```{r}
t.test(data = mydat, lifeExp ~ country)
```


## Scatter plot and pearson correlation

![Artwork by @allison_horst](https://cfss.uchicago.edu/media/allison_horst_art/presenting_monster_hu19027c6bf39be6f35de5f2a07de7eee0_1253011_1200x1200_fit_lanczos_2.png)

In statistics, you deal with a lot of data. The hard part is finding patterns that fit the data. To look for patterns, there are several statistical tools that help identify these patterns. But before you use any of these tools, you should look for basic patterns. As you learned, you can identify basic patterns using a scatter plot and correlation.

Import Gapminder dataset:
```{r}
library(gapminder)
data("gapminder")

```



Let's create a simple scatter plot:

```{r}
plot(gapminder$lifeExp,gapminder$gdpPercap)
```

You could see from the scatter plot that including this line, add more information about the slope/direction of the relationship.

```{r}
plot(gapminder$lifeExp,gapminder$gdpPercap)
abline(lm(gdpPercap~lifeExp,gapminder), col ="blue")

```

According to this figure, we might conclude that there is a weak association between GDP and LifeExp variables. Also, we cannot clearly define the direction of this association. Relying on the interpretation of a scatterplot is too subjective. More precise evidence is needed, and this evidence is obtained by computing a coefficient that measures the strength of the relationship under investigation.


```{r}
library(ggplot2)
ggplot(gapminder,aes(x = lifeExp, y = gdpPercap)) + 
  geom_point() + facet_wrap(~continent) + geom_smooth(method = 'lm')
```

```{r}
ggplot(
  data = gapminder,
  mapping = aes(x = lifeExp, y = gdpPercap)
) +
  geom_point(alpha = .1) +
  geom_smooth(se = FALSE) +
  labs(
    title = "Relationship between GDP per capita and Life Expectancy",
    subtitle = "Gapminder dataset - Worldwide",
    x = "GDP (euro)",
    y = "Life Expectancy (years)"
  ) +
  theme_minimal()
```

Because both are both continuous variables, will use Pearsonâ€™s product-moment correlation to quantify the strength of the relationship between these two variables. There are a few ways to do this in R, but we will only consider one method here.

```{r}

# correlation between both variables
cor(gapminder$lifeExp,gapminder$gdpPercap)
# Calculating Pearson's product-moment correlation
 cor.test(gapminder$lifeExp,gapminder$gdpPercap, method = "pearson", conf.level = 0.95)
```

---
This work is licensed under the [CC BY-NC 4.0 Creative Commons License](http://creativecommons.org/licenses/by-nc/4.0/).